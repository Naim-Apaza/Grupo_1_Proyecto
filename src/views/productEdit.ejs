<!DOCTYPE html>
<html lang="en">
  <!-- Encabezado -->
  <%- include('./partials/head')%>
  <body>
    <!-- Barra de navegacion -->
    <%- include('./partials/header') %>

    <!-- Contenido principal -->
    <main class="edit-main">
      <div class="edit-header">
        <img class="header-logo" src="/images/gz-logo.png" alt="logo" />
      </div>
      <div class="edit-container">
        <h1 class="edit-title">Editar</h1>
        <form
          action="/products/edit/<%=producto.id_producto%>?_method=PUT"
          class="edit-form"
          method="post"
          enctype="multipart/form-data"
        >
          <div class="field">
            <label class="label" for="nombre">Juego</label>
            <input
              class="input"
              id="nombre"
              type="text"
              name="nombre"
              value="<%= producto.nombre %>  "
              placeholder="Inserte un nombre..."
              required
            />
          </div>
          <div class="field">
            <label class="label" for="precio">Precio</label>
            <input
              class="input"
              type="number"
              step="any"
              id="precio"
              maxlength="7"
              minlength="1"
              max="99999"
              min="0"
              value="<%= producto.precio %>"
              name="precio"
              placeholder="Introduzca el valor del juego..."
              required
            />
          </div>
          <div class="field">
            <label class="label" for="descuento">Descuento</label>
            <input
              id="descuento"
              class="input"
              type="number"
              name="descuento"
              min="0"
              max="100"
              maxlength="3"
              minlength="1"
              value="<%= producto.cant_desc %>"
              placeholder="Introduzca el descuento (opcional)"
            />
          </div>
          <div class="field">
            <label class="label" for="plataforma">Plataformas</label>
            <select name="plataforma" size="4" required id="plataforma">
              <% for(let j=0;j < plataformas.length;j++) { %> 
                <% if(producto.plataformas.id_plataforma == plataformas[j].id_plataforma) { %>
                  <option value="<%= plataformas[j].id_plataforma %>" selected>
                    <%=plataformas[j].nombre %>
                  </option>
                <% } else { %>
                  <option value="<%= plataformas[j].id_plataforma %>">
                    <%=plataformas[j].nombre %>
                  </option>
                <% } %> 
              <% } %>
            </select>
          </div>
          <div class="field">
            <label class="label" for="tag">Categoría</label>
            <select name="tag" multiple required id="tag">
              <% for(let j = 0;j < categorias.length;j++) { %> 
                <% for(let k = 0;k < pivot.length;k++) { %>
                  <% if(pivot[k].id_categoria == categorias[j].id_categoria) { %>
                    <option value="<%= categorias[j].id_categoria %>" selected>
                      <%=categorias[j].nombre %>
                    </option>
                  <% } else { %>
                    <option value="<%=categorias[j].id_categoria%>">
                      <%=categorias[j].nombre %>
                    </option>
                    <% } %> 
                <% } %>
              <% } %>
            </select>
          </div>
          <div class="field">
            <label class="label" for="imagen">Imagen</label>
            <input
              class="input"
              type="file"
              name="imagen"
              id="imagen"
              value="<%= producto.image %>"
            />
          </div>
          <div class="detail">
            <label for="detalle" class="label">Descripción</label>
            <textarea
              required
              id="detalle"
              name="detalle"
              cols="30"
              rows="10"
              placeholder="Introduzca una descripcion del juego.."
            ><%= producto.descripcion %>
            </textarea>
          </div>
          <button class="editar-button" type="submit">Editar</button>
        </form>
      </div>
    </main>

    <!-- Footer -->
    <%- include('./partials/footer') %>
  </body>
</html>
